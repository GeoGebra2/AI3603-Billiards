# AI3603-Billiards 新智能体 NewAgent 介绍文档

## 概述
- 本项目在不修改 `poolenv.py` 的前提下实现并接入 `NewAgent`，与课程提供的 `BasicAgent` 进行对战评估。
- `NewAgent` 采用启发式候选生成 + 物理仿真评估 + 局部微调的策略，在可复现的设置下追求稳定的进球与低犯规。

## 算法设计
- 候选生成：基于台面状态，选择距离白球最近的若干目标球，按从白球到目标球的几何方向生成若干角度与速度组合，并叠加轻微杆头偏移组合。
- 物理仿真评估：对每个候选动作使用 `pooltool` 仿真，记录事件并依据项目内置评分函数进行打分。
- 评分函数：使用 `agent.py` 中的 `analyze_shot_for_reward`，综合进己方球、合法黑 8、犯规项与防守因素。
- 局部微调：对初筛最高分动作在角度与速度附近做小范围微调，进一步提升得分与鲁棒性。
- 终局策略：当己方球清空后自动切换目标为黑 8。

## 代码结构与改动
- `agent.py`：新增并实现 `NewAgent`，核心方法 `decision(balls, my_targets, table)` 输出动作参数 `V0, phi, theta, a, b`。
- `evaluate.py`：默认使用 `agent_b = NewAgent()`，执行 40 局对战并输出统计结果。
- `utils.py`：当前未使用，可作为后续通用工具的扩展位置。

## 使用指南
- 环境：建议 Python 3.10+，按项目指南执行 `pip install -r requirements.txt`。
- 评估：在项目根目录运行 `python evaluate.py`，脚本将进行 40 局循环轮换对战并输出最终统计分数与胜率。
- 依赖：需安装 `pooltool`（包含在 `requirements.txt` 中）。如缺失依赖，请先完成安装再运行评估脚本。

## 参数与可调项
- 候选规模：目标球数量上限、角度扰动集合、速度候选集合、杆头偏移集合。
- 微调范围：角度与速度的微小扰动、偏移微调集合。
- 以上参数在 `NewAgent` 构造函数中配置，可按训练阶段做网格/贝叶斯搜索优化。

## 评估与结果
- 评分脚本：`evaluate.py`，胜负统计与胜率计算见项目规则说明。
- 为获得稳定结果，请确认依赖安装完备；如需更快验证，可减小对战局数进行快速测试，正式评分按 40 局执行。

## 后续改进建议
- 结合 MCTS 或 RL（PPO/SAC）进一步提升策略与长远规划能力。
- 基于数据驱动优化评分权重与候选参数范围。
- 加入安全球与解球的特定模式，提高在复杂局面的稳定性。